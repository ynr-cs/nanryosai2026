# Account & Terms 開発コンテキスト

本ドキュメントは、マイページ機能 (`account.html`) および 利用規約ページ (`terms.html`) の開発ガイドラインです。

## 1. マイページ (`account.html`) 機能概要

**基本方針**: ユーザーのエンゲージメントを高めるハブとして機能する。認証状態に応じて表示を切り替え、未ログインユーザーにはログインを促す。

### 1.1 認証状態によるフロー

1.  **ゲスト (Guest View)**

    - **UI**: 「ログインが必要です」というメッセージとログインボタンのみを表示。
    - **目的**: 心理的障壁を下げつつ、機能利用の前提としてのログインを促す。
    - **アクション**: ログインボタン押下で Google ログインを実行 (`triggerLogin`)。

2.  **ログイン済み (Authenticated View)**
    - **プロファイル**: アイコン、名前、メールアドレスを表示。
    - **ダッシュボード**:
      - **お気に入り**: (未実装) お気に入り登録数。
      - **注文数**: 過去の注文総数を表示。クリックで注文履歴セクションへスクロール。
    - **注文履歴 (Order History)**:
      - **UI**: デフォルトで折りたたまれた状態。展開すると直近 10 件を表示。
      - **内容**: 店舗名、日時、商品詳細、合計金額、ステータスバッジ。
      - **ステータス**: 調理中、呼出中、受取済などを色分けして表示。
    - **設定 (Settings)**:
      - **呼び出し通知**: FCM トークンの保存リクエスト。iOS/Mac などの非対応環境では無効化表示。
      - **利用規約リンク**: `terms.html` への遷移。
      - **アカウント削除**: Firestore および Authentication からユーザーを完全削除 (Danger Zone)。

### 1.2 実装詳細要件

- **アコーディオン UI**: 履歴セクションは `max-height` トランジションで開閉。
- **ローディング**: 読み込み中はスケルトンスクリーン (`loading-skeleton`) を表示。
- **ホバーエフェクト**: カード等のインタラクティブ要素に `transform` や `box-shadow` を適用。

## 2. 利用規約ページ (`terms.html`)

- **役割**: サービス利用におけるルールの明示。
- **内容**:
  - **重要事項**: キャンセル不可、受取期限 (15 分)。
  - **BAN 警告**: 違反時はコンピュータ科学部作成サービスからの BAN。
  - **運営情報**: 横浜南陵高校コンピュータ科学部による運営。
  - **免責・禁止事項**: システム的な責任範囲の明記。
- **デザイン**: `style.css` (App Shell) をベースにした統一感のあるデザイン。

## 3. 最新の開発履歴 (2026-01-01 更新)

### 3.1 機能追加

- **ゲスト表示の簡素化 (完了)**: 未ログイン時の情報を隠蔽し、ログイン誘導に特化。
- **利用規約ページの独立 (完了)**: `mobile-order.html` 内の規約コンテンツを独立ページ化し、文言を強化。
- **アカウント削除機能 (完了)**: 物理削除 (`deleteDoc`, `deleteUser`) の実装と再認証フローの考慮。

### 3.2 UI/UX 改善

- **通知設定の堅牢化**: iOS/Mac 判定によるスイッチ無効化、Service Worker 登録待ちによるトークン取得エラーの回避。
- **インタラクション**: 各所へのホバーアニメーション追加。
