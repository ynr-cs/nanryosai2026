# 新規店舗追加・同期 完全ワークフロー

新規店舗を作成し、`data.js`（コードマスター）と Firebase（本番DB）の両方に正しく同期させるための手順書です。

## 前提

1.  作業は **PC上のブラウザ** で行います。
2.  ローカルサーバーで `main/admin_sync.html` を開いている状態とします。
3.  スーパー管理者アカウント（`ynrcs1000@gmail.com` 等）でログインしている必要があります。

---

## 手順 1: 管理画面でのデータ作成

1.  **新規追加**: `admin_sync.html` 上部の緑色のボタン **「＋ 新規店舗追加」** をクリックします。
2.  **基本情報入力**: 表の一番下に追加された行に、以下の情報を入力します。
    - **ID**: ユニークなID（例: `301`, `tea_club`）。**最重要項目**です。
    - **LoginID**: 基本的にIDと同じでOK（例: `301`）。
    - **クラス名/団体名**: 例「3年1組」「茶道部」。
    - **企画名**: 例「焼きそば屋」「お茶会」。
    - **種類**:
      - 食品販売・物販なら `Menu (販売)` を選択。
      - 展示・発表のみなら `Gallery (展示)` を選択。
3.  **メニュー登録** (種類が `Menu` の場合のみ):
    - 「メニュー」列の **「編集」** ボタンをクリック。
    - 商品名、価格を入力して「保存して閉じる」。

## 手順 2: パスワード設定 (Cloud Functions)

1.  作成した行の右側にある **「🔑 (鍵アイコン)」** をクリックします。
2.  パスワードを入力します（デフォルトでは ID が入力されています）。
3.  OKを押すと、クラウド上の安全な領域（`store_secrets`）にパスワードが保存されます。
    - _注意: この情報は `data.js` には保存されません。クラウド設定のみです。_

## 手順 3: Firestore への同期 (本番反映)

モバイルオーダーアプリで表示させるために、データをアップロードします。

1.  ツールバー右側の青いボタン **「🔥 Firestore同期 (店舗情報)」** をクリック。
    - → これで店名などがアプリに表示されます。
2.  (Menuの場合) 緑色のボタン **「🍴 Firestore同期 (メニュー)」** をクリック。
    - → これで商品リストがアプリに表示されます。

## 手順 4: data.js の更新 (コードマスター保存)

次回以降もこのデータが消えないように、コードファイルに保存します。

1.  ツールバー左側の黄色のボタン **「💻 data.js 生成 (全コピー用)」** をクリック。
2.  下の黒いテキストエリアにコードが表示されるので、**全て選択してコピー** します (`Ctrl+A` → `Ctrl+C`)。
3.  エディタ（VS Code）で `main/data/data.js` を開きます。
4.  **中身を全て消して、コピーしたコードを貼り付け** 保存します。

## 手順 5: 画像ファイルの配置

画像は自動同期されないため、手動で配置します。

1.  使用する画像ファイル（正方形推奨、PNG/JPG）を用意します。
2.  ファイル名を **`{ID}.png`** に変更します（例: `301.png`）。
3.  プロジェクトの `images/` フォルダの中にファイルを移動します。
    - パス: `nanryosai-2026/images/301.png`
4.  必要であればGitにコミットしてGitHub等にプッシュします（画像はStorageではなくGithub Pages/Hostingから配信される場合が多いですが、現仕様では相対パス参照されています）。

---

## 完了チェックリスト

- [ ] アプリ (`mobile-order.html`) で新しい店舗が表示されるか？
- [ ] 店舗に入ってメニューが表示されるか？
- [ ] `main/data/data.js` が更新されているか？
- [ ] 画像が表示されているか？
